--- 
title: |
   ![](images/cover.jpg){width=400px style="display: block; margin:0 auto; align:center;" }
   <center> **<span style="color:#003300;">Manual para la Identificación de los hotspots del dengue en áreas urbanas de México</span>** </center>
author: "Felipe Antonio Dzul Manzanilla"
date: "2021: Last compiled `r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
biblio-style: apalike
link-citations: yes
github-repo: fdzul/manual_hotspots
cover-image: images/cover.jpg
url: https://fdzul.github.io/manual_hotspots/
favicon: "favicon.ico"
description: "El manual describe la Identificación de los hotspots en R"
---

# **<span style="color:#003300;">Prologo</span>**{-}

<hr style="height:2px;border-width:0;color:#330019;background-color:#330019"> 

# **<span style="color:#003300;">Justificación</span>**{-}

<hr style="height:2px;border-width:0;color:#330019;background-color:#330019"> 

El programa de prevención y control del dengue en México se enfrenta a grandes desafíos que incluyen:

 - Expanción geográfica del dengue.
 - Incremento de la transmisión en zonas endémicas y no endémicas.
 - Presencia de brotes en zonas urbanas que contituyen grandes metropolis (Guadalajara, Monterrey, La comarca Lagunera, etc).
 - Potencial introducción de nuevos agentes causales, como la Fiebre Amarilla y Mayaro.


El desarrollo de un modelo estratégico de focalización de las acciones antivectoriales en las áreas urbanas endémicas de México y su implementación, constituye un elemento clave para redirigir los límitados recursos materiales, humanos y económicos a las áreas de los grandes centros urbanos donde la transmisión se concentra (basados en datos históricos) y donde las cadenas de transmisión son activas (datos actuales). Teóricamente, de acuerdo a la ley de Pareto 80/20, si el 80% de la transmisión se concentra en el 20% del área urbana, la focalización de las acciones en el 20% del área, permitiría obtener reducciones del 80% de la carga de la enfermedad. 

# **<span style="color:#003300;">Software & Convenciones</span>** {-}

<hr style="height:2px;border-width:0;color:#330019;background-color:#330019"> 

Con el advenimiento de la era del internet, la exponencial la capacidad de las computadoras (software and hardware) y la creciente la disponibilidad software libre para el análisis espacial, ha permitido que más investigadores tengan acceso a las herramientas analíticas. En el top ten para el análisis de datos espaciales, se observan a [QGIS](http://www.qgis.org/es/site/ ), **[R](https://cran.r-project.org/)**, [Python](https://www.python.org/), [GeoDa](https://spatial.uchicago.edu/software), [SaTScan](https://www.satscan.org/) y [GRASS](https://grass.osgeo.org/). Actualmente, existe una tendencia a usar R o Python para el análisis espacial. Entre las principales limitantes de ambos lenguajes de programación es que la curva de aprendizaje es lenta y tortuosa. No obstante, lo anterior, cada día más personas están usando ambos lenguajes para el análisis espacial. 

En el presente manual se usará **[R](https://cran.r-project.org/)** y **[RStudio](https://www.rstudio.com/)** para el cálculo de los hotspots. El manual asume que los usuarios tienen experiencia en el uso de R, RStudio y que cuentan con su clave API del servicio de geocodificacion de google ([Geocoding API de google](https://developers.google.com/maps/documentation/geocoding/overview)). **[R](https://cran.r-project.org/)** es un programa de computadora estadístico que proporciona un ambiente rico y variado para la visualización y análisis de datos (espaciales y no espaciales). **[R](https://cran.r-project.org/)** se baja gratis del website de Comprensive R Archive Network en https://cran.r-project.org/ y es distribuido con una licencia pública general (GBU). Lo ideal es usar la consola de **[R](https://cran.r-project.org/)**, pero es ampliamente recomendado utilizar un ambiente de desarrollo integrado (IDE, integrated development enviroment) para interactuar con **[R](https://cran.r-project.org/)**, como **[RStudio](https://www.rstudio.com/)**. **[RStudio](https://www.rstudio.com/)** se baja gratis en la página de RStudio https://rstudio.com/products/rstudio/.


Los análisis hotspots con el estadístico espacial local Getis&Ord ($G_{i}^{*}$) tanto para los datos históricos de los casos y del vector (ovitrampas), así como **Space-Time análisis** con **[SaTScan](https://www.satscan.org/)** y **[ClusterSeer](https://www.biomedware.com/software/clusterseer/)** son implementados en **[R](https://cran.r-project.org/)** y se desarrollaron los siguientes paquetes para facilitar su implementación en los servicios de salud de México.

* **[denhotspots](https://github.com/fdzul/denhotspots)**
* **[deneggs](https://github.com/fdzul/deneggs)**
* **[rgeomex](https://github.com/fdzul/rgeomex)**
* **[dendata](https://github.com/fdzul/dendata)**

Los paquetes se instalan en la consola de **[R](https://cran.r-project.org/)** o **[RStudio](https://www.rstudio.com/)** en tecleando lo siguiente:

```{r, warning=FALSE, error=FALSE, message=FALSE}
#devtools::install_github("fdzul/denhotspots")
#devtools::install_github("fdzul/deneggs")
#devtools::install_github("fdzul/rgeomex")
#devtools::install_github("fdzul/dendata")
```
ó
```{r,warning=FALSE, error=FALSE, message=FALSE}
#remotes::install_github("fdzul/denhotspots")
#remotes::install_github("fdzul/deneggs")
#remotes::install_github("fdzul/rgeomex")
#remotes::install_github("fdzul/dendata")
```

Por convención en el texto los paquetes se proporcionaran en negrita y azul marino (ejemplo **[denhotspots](https://github.com/fdzul/denhotspots)**). Las funciones puedes referirse individualmente (**[extract_ageb]()**) o a través de su paquete (***[rgeomex::extract_ageb]()***) en cursiva y color azul marino. En el caso de ***[denhotspots::gihi]()***, **[denhotspots]()** es el paquete y ***[gihi]()*** es la función. En los códigos las funciones de los paquetes **[denhotspots](https://github.com/fdzul/denhotspots)**,**[deneggs](https://github.com/fdzul/deneggs)**, **[rgeomex](https://github.com/fdzul/rgeomex)** y **[dendata](https://github.com/fdzul/dendata)** usaran este metodo de applicar la función atravez de ***:*** debido a que evita conflictos con otros paquetes que tienen funciones con el mismo nombre pero que realizan diferente función.

Como el documento incluye texto y código, el código estara cirscunscrito en un recuadro con fondo <span style="color:#567482">gris</span> como  acontinuación se presenta. El símbolo **#** indica un comentario del código, no tiene efecto en R y como resultado no se correrá la pieza del código. 

```{r,warning=FALSE, error=FALSE, message=FALSE}
#devtools::install_github("fdzul/denhotspots")
```

En el código (recuadro gris) a las funciones se les asignará un color **<span style="color:#06287e">azul</span>**, a los paquetes un color **<span style="color:#567482">gris</span>**, a los **argumentos** de la funciones se les asignará un color **<span style="color:#7d9029">verde</span>** y a los **valores** de los argumentos se les asignará un color **<span style="color:#06287e">azul</span>**.

```{r, warning=FALSE, error=FALSE, message=FALSE}
library(sf)
library(magrittr)
gua <- rgeomex::extract_ageb(locality = c("Zapopan", "Tonalá",
                                          "Tlaquepaque", "Guadalajara"),
                             cve_geo = "14")
```

```{r, warning=FALSE, error=FALSE, message=FALSE}
plot(sf::st_geometry(gua$locality))
```

# **<span style="color:#003300;">Estructura de Manual</span>**{-}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019"> 

# **<span style="color:#003300;">Agradecimientos</span>**{-}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019"> 



<!--chapter:end:index.Rmd-->

# **<span style="color:#003300;" >Introducción </span>** {#intro}

<hr style="height:2px;border-width:0;color:#330019;background-color:#330019"> 

<span style="color:#660033;">Los hotspots de las arbovirosis transmitidas por Aedes aegypti son definidas como aquellas áreas donde se concentra la mayor carga de la transmisión de los virus del dengue, chikungunya y/o zika (Bisanzio et al 2017; Dzul-Manzanilla et al 2021). Actualmente, los hotspots son la principal estrategia de identificación de las áreas de riesgo en el interior de los grandes centros urbanos endémicos de dengue y es ampliamente recomendada por la Organización Panamericana de de la Salud (2019) y grupos científicos (Vanlerberghe et al., 2017;  Olliaro et al., 2018 Roiz et al., 2019).</span>

<span style="color:#660033;">Los procedimientos y cálculos en los respectivos programas (GeoDA, ArcView, ArcGis, R y Python) es completemente restrictivo a la comunidad científica y grupos académicos con expertis. La operacionalización de los algoritmos para la identificación de los hotspots en los programas de salud en México, es el paso siguiente que se requiere para que la estrategía de focalización de los hotspots se escale en todo el país.</span>

<span style="color:#660033;">En el presente manual se describen los pasos lógicos para la identificación de los hotspots de los casos de dengue y los hotspots de la abundancia el vector usando bases de datos históricas y bases de datos recientes. Así mismo, se describe la identificación de cluster de transmisión y la identificación de las cadenas  de transmisión. Todos los análisis espaciales son implementados en R.</span>

<!--chapter:end:01-intro.Rmd-->

# **<span style="color:#003300;"> Objetivo </span>** {#objetivos}

<hr style="height:2px;border-width:0;color:#330019;background-color:#330019"> 

<span style="color:#660033;">I.	Unificar y estandarizar los criterios, instrumentos, y cálculos que se requieren para la identificación de los hotspots en las áreas urbanas endémicas de dengue en México.</span>

<span style="color:#660033;">II. Unificar y estandarizar los criterios, instrumentos, y cálculos que se requieren para identificación de las cadenas de transmisión en las áreas urbanas endémicas de dengue en México.</span>


<span style="color:#660033;">III. Unificar y estandarizar los criterios, instrumentos, y cálculos que se requieren para identificación de los clusters de transmisión en las áreas urbanas endémicas de dengue  en México.</span>

<span style="color:#660033;">El manual para la identificación de los hotspots en las localidades urbanas endémicas no solo está dirigido al personal operativo, mandos medios y directivos de los Programas de Prevención y Control de las arbovirosis transmitidas por ***Aedes*** de la Secretaria de Salud de México, sino también a la comunidad académica relacionada con la investigación operativa sobre los hotspots de dengue y al público en general interesado en el tema.</span>

<!--chapter:end:02-objetivos.Rmd-->


# **<span style="color:#003300;">Hotspots</span>** {#hotspots}

Placeholder


## **Análisis de la Información epidemiológica y entomológica**
## **Hotspots de transmisión histórica**
### Algoritmo para el cálculo de los **hotspots de transmisión**
### **Referencias**

<!--chapter:end:03-hotspots.Rmd-->


# **Cálculo de los Hotspots en R** {#hotspotsr}

Placeholder


## Bajar las bases de datos del [SINAVE](https://www.sinave.gob.mx/).
### Escribir en el buscador de preferencia la página del sinave (https://www.sinave.gob.mx/).
### En la página del sinave buscar y darle click al **boton Enfermedades Transmitidas por Vector**.
### Ingresar el nombre del usurio y contraseña.
### Ingresar a la sección de **Reportes**.
### Darle click a **Descarga de Datos Vectores**
### Bajar la base de datos de la última fecha de la enfermedad de interés.
### Guardar la base en la carpeta de interes.
### Extraer el txt del archivo con extensión RAR.
## Geocodificación de la base de datos de Dengue.
### Subir la base de datos de Dengue a ![](https://d33wubrfki0l68.cloudfront.net/62bcc8535a06077094ca3c29c383e37ad7334311/a263f/assets/img/logo.svg){width=10%}
#### Subir la base de datos de dengue de la semana actual.
#### Subir la base de datos de dengue de la semana pasada
#### Ordenar la base por el ID del paciente y extraer los casos no geocodificados de la semana actual.
#### Guardar el resultado
#### head(), dim() y names()
### Subir el csv a ![](https://d33wubrfki0l68.cloudfront.net/62bcc8535a06077094ca3c29c383e37ad7334311/a263f/assets/img/logo.svg){width=10%} y creamos el vector de direcciones
### Realizar la geocodificación
#### manipulación de texto
#### Geocodificación.
###  Guardar la información en RData
#### Subir la base geocodificada
#### Subir la base de casos
#### Elminar duplicados y guardar
## Bajar los shapefile del [INEGI](https://www.inegi.org.mx/).
## Contar el número de casos por AGEB (agregación espacial).
### subir la base datos geocodificada.
### subir los AGEBs.
### Realizar la agregación espacial. 
## Pasos 6-10. Cálcular el Z-score de los casos a Calcular los hotspots.
## Visualizar los hotspots.

<!--chapter:end:04-hotspotsr.Rmd-->

